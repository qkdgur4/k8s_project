// frontend/views/list.pug (ìµœì¢… ì™„ì„±ë³¸ - Auth ì¶”ê°€)

if reviews && reviews.length > 0
  h3.my-4.text-primary ì‘ì„±ëœ ê¸€ ëª©ë¡
  .row
    for review in reviews
      .col-12.mb-4
        .card.shadow-sm.border-0.rounded
          .card-body.p-4
            .d-flex.justify-content-between.align-items-center.mb-2
              div
                h5.card-title.font-weight-bold.mb-0 #{review.store}
                //- ğŸŸ¢ ì‘ì„±ì ì´ë¦„(AuthorName)ì„ DBì—ì„œ ê°€ì ¸ì˜´
                small.text-muted (#{review.AuthorName || review.name})
              div.text-right
                - const rating = parseInt(review.taste) || 0
                span.h5.text-warning.mb-0 #{'â˜…'.repeat(rating)}#{'â˜†'.repeat(5 - rating)}
                br
                small.text-muted ë§› í‰ì 

            h6.card-subtitle.mb-3.text-muted #{review.category} / #{review.menu}
            p.card-text.mb-3
              strong íƒœê·¸:
              if Array.isArray(review.tags) && review.tags.length > 0
                each tag in review.tags
                  a.badge.badge-info.mr-1.mb-1(href=`/?tag=${tag}`)= tag
              else
                span.text-muted.ml-2 -
            p.card-text.mb-3
              strong ì¶”ì²œ:
              if review.recommend === 'yes'
                span.badge.badge-success.ml-2 ì¶”ì²œí•´ìš” ğŸ‘
              else
                span.badge.badge-secondary.ml-2 ì•„ì‰¬ì›Œìš” ğŸ‘

            .d-flex.justify-content-between.align-items-end.border-top.pt-3.mt-3
              small.text-muted.review-memo #{review.memo || 'ë©”ëª¨ ì—†ìŒ'}
              small.text-muted.review-date #{new Date(review.createdAt).toLocaleDateString()}
            
            //- ğŸŸ¢ 1. ë²„íŠ¼ ë˜í¼ì— 'review-actions' í´ë˜ìŠ¤ ì¶”ê°€
            //- ğŸŸ¢ 2. 'data-author-id' ì†ì„±ì— ì‘ì„±ì ID ì‹¬ê¸°
            .text-right.mt-2.review-actions(data-author-id=review.AuthorID)
              a.btn.btn-sm.btn-outline-info.mr-2(
                href=`https://search.naver.com/search.naver?query=#{encodeURIComponent(review.store || '')}`,
                target='_blank', rel='noopener'
              ) ğŸ—ºï¸ ìì„¸íˆ ë³´ê¸°
              
              //- ğŸŸ¢ 3. ì´ ë²„íŠ¼ë“¤ì€ JSê°€ ìˆ¨ê¹€/í‘œì‹œ ì²˜ë¦¬ (ê¸°ë³¸ ìˆ¨ê¹€)
              a.btn.btn-sm.btn-outline-secondary.edit-btn(
                href=`/reviews/${review._id}/edit`,
                target='_blank', rel='noopener', style="display: none;"
              ) âœ ìˆ˜ì •í•˜ê¸°
              button.btn.btn-sm.btn-danger.ml-2.delete-btn(
                type='button',
                onclick=`deleteReview('${review._id}')`, style="display: none;"
              ) ğŸ—‘ ì‚­ì œ
else
  .alert.alert-info(role='alert')
    | ì•„ì§ ì‘ì„±ëœ ë¦¬ë·°ê°€ ì—†ìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ ë¦¬ë·°ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”!