// frontend/views/home.pug (ìµœì¢… ì™„ì„±ë³¸ - JS ì•ˆì •ì„± ê°•í™”)

doctype html
html
  head
    meta(charset='utf-8')
    title í•œìž…ë¡œê·¸
    meta(name='viewport', content='width=device-width, initial-scale=1')
    link(rel='stylesheet', href='https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css')
    link(rel='stylesheet', href='/css/style.css')
  body
    #header-section.header.bg-light.mb-0
      .container
        h1: a(href='/', class='text-dark text-decoration-none') í•œìž…ë¡œê·¸ðŸ½
        p.text-muted.mb-0 ìž‘ì€ í•œìž…ì—ë„ ì´ì•¼ê¸°ê°€ ë‹´ê²¨ìš” ðŸ²

    #form-section.container.mb-5(style="display: none;")
      h3.mb-4.text-primary âœï¸ ìƒˆ ë¦¬ë·° ìž‘ì„±
      form#new-review-form
        .form-group
          label(for='name') ì´ë¦„
          input#name.form-control(type='text' name='name' placeholder='ìµëª…ë„ ê°€ëŠ¥í•´ìš”' required)
        .form-group
          label(for='store') ê°€ê²Œëª…
          input#store.form-control(type='text' name='store' placeholder='ë°©ë¬¸í•œ ìŒì‹ì  ì´ë¦„ì„ ì ì–´ì£¼ì„¸ìš”' required)
        .form-group
          label(for='category') ìŒì‹ ë¶„ë¥˜
          select#category.form-control(name='category' required)
            option(value='') -- ì„ íƒ --
            option(value='í•œì‹') í•œì‹
            option(value='ì¤‘ì‹') ì¤‘ì‹
            option(value='ì¼ì‹') ì¼ì‹
            option(value='ì–‘ì‹') ì–‘ì‹
            option(value='ë¶„ì‹') ë¶„ì‹
            option(value='ê¸°íƒ€') ê¸°íƒ€
        .form-group
          label(for='menu') ë¨¹ì€ ìŒì‹
          input#menu.form-control(type='text' name='menu' placeholder='ì˜ˆ: ê¹€ì¹˜ì°Œê°œ, í¬ë¦¼íŒŒìŠ¤íƒ€ ë“±' required)
        .form-group
          label(for='taste') ë§› í‰ì 
          select#taste.form-control(name='taste' required)
            option(value='') -- ì„ íƒ --
            option(value='5') â˜…â˜…â˜…â˜…â˜…
            option(value='4') â˜…â˜…â˜…â˜…â˜†
            option(value='3') â˜…â˜…â˜…â˜†â˜†
            option(value='2') â˜…â˜…â˜†â˜†â˜†
            option(value='1') â˜…â˜†â˜†â˜†â˜†
        .form-group
          label íƒœê·¸ (ìµœì†Œ 1ê°œ ì´ìƒ ì„ íƒ)
          .tag-selector.border.p-3.rounded
            - const tags = [{emoji: 'ðŸ‘¥', label: 'ë‹¨ì²´ì„'}, {emoji: 'ðŸª‘', label: 'ìž…ì‹'}, {emoji: 'ðŸ§‘â€ðŸ³', label: 'íŠ¹ë³„í•œë©”ë‰´'}, {emoji: 'ðŸ›‹ï¸', label: 'ì¸í…Œë¦¬ì–´'}, {emoji: 'ðŸŒ¿', label: 'ì‹ ì„ í•œ'}, {emoji: 'ðŸ’•', label: 'ë°ì´íŠ¸'}, {emoji: 'ðŸ‘€', label: 'ë„“ì€'}, {emoji: 'ðŸ‘¥', label: 'íšŒì‹'}, {emoji: 'ðŸ—£ï¸', label: 'ëŒ€í™”'}, {emoji: 'ðŸ™', label: 'í˜¼ë°¥'}, {emoji: 'ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦', label: 'ê°€ì¡±ëª¨ìž„'}, {emoji: 'âœ¨', label: 'ë¶„ìœ„ê¸°ì¢‹ì€'}, {emoji: 'ðŸ†•', label: 'ìƒˆë¡œì˜¤í”ˆ'}]
            each tag in tags
              .form-check.form-check-inline
                input.form-check-input(type='checkbox', name='tags', id=`tag-${tag.label}`, value=tag.label)
                label.form-check-label(for=`tag-${tag.label}`)= `${tag.emoji} ${tag.label}`
        .form-group
          label(for='memo') ì¶”ê°€ ë©”ëª¨
          textarea#memo.form-control(name='memo' rows='4' placeholder='ìœ„ìƒ ìƒíƒœ, ìœ„ì¹˜, ê±¸ë¦¬ëŠ” ì‹œê°„ ë“±ì„ ì ì–´ì£¼ì„¸ìš”')
        .form-group
          label(for='recommend') ì¶”ì²œ ì—¬ë¶€
          select#recommend.form-control(name='recommend' required)
            option(value='') -- ì„ íƒ --
            option(value='yes') ì¶”ì²œí•´ìš” ðŸ‘
            option(value='no') ì•„ì‰¬ì›Œìš” ðŸ‘Ž
        button.btn.btn-success.btn-block(type='submit') ìž‘ì„± ì™„ë£Œ
        button.btn.btn-secondary.btn-block(type='button')#hide-form-btn ì·¨ì†Œ

    #page-content
      .container.mb-5
        .d-flex.justify-content-between.align-items-center.mb-4
          div
            - const categories = ['ì „ì²´', 'í•œì‹', 'ì¤‘ì‹', 'ì¼ì‹', 'ì–‘ì‹', 'ë¶„ì‹', 'ê¸°íƒ€']
            each cat in categories
              a(href=`/?category=${cat}`, class=`btn ${currentCategory === cat ? 'btn-primary' : 'btn-outline-secondary'} mr-2 mb-2`)= cat
          div
            button.btn.btn-primary.btn-sm#show-form-btn âœï¸ ìƒˆ ë¦¬ë·° ìž‘ì„±
      .container-fluid.posts.mt-5
        include list.pug
  
  //- ðŸŸ¢ðŸŸ¢ðŸŸ¢ ì—¬ê¸°ê°€ ìˆ˜ì •ëœ ìŠ¤í¬ë¦½íŠ¸ìž…ë‹ˆë‹¤ ðŸŸ¢ðŸŸ¢ðŸŸ¢
  script.
    document.addEventListener('DOMContentLoaded', () => {
      // ëª¨ë“  ì„¹ì…˜ê³¼ ë²„íŠ¼ì„ ì•ˆì „í•˜ê²Œ ì„ íƒí•©ë‹ˆë‹¤.
      const header = document.getElementById('header-section');
      const pageContent = document.getElementById('page-content');
      const formSection = document.getElementById('form-section');
      const showButton = document.getElementById('show-form-btn');
      const hideButton = document.getElementById('hide-form-btn');

      // ðŸŸ¢ 'showButton'ì´ ì‹¤ì œë¡œ ì¡´ìž¬í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
      if (!showButton) {
        console.error('Error: "show-form-btn"ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
        return; // ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì¤‘ë‹¨
      }
      // ðŸŸ¢ 'formSection' ë“±ì´ ì‹¤ì œë¡œ ì¡´ìž¬í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
      if (!formSection || !hideButton || !header || !pageContent) {
        console.error('Error: íŽ˜ì´ì§€ì˜ í•„ìˆ˜ êµ¬ì„±ìš”ì†Œ(form, header ë“±)ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
        return; // ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì¤‘ë‹¨
      }

      function toggleSections(showForm) {
        if (showForm) {
          formSection.style.display = 'block';
          header.style.display = 'none';
          pageContent.style.display = 'none';
        } else {
          formSection.style.display = 'none';
          header.style.display = 'block';
          pageContent.style.display = 'block';
        }
      }
      function updateVisibility() {
        if (window.location.pathname === '/reviews/new') {
          toggleSections(true);
        } else {
          toggleSections(false);
        }
      }

      // ðŸŸ¢ "ë²„íŠ¼ì´ ì¡´ìž¬í•  ë•Œë§Œ" ì´ë²¤íŠ¸ë¥¼ ì—°ê²°í•©ë‹ˆë‹¤.
      showButton.addEventListener('click', () => {
        history.pushState(null, '', '/reviews/new');
        updateVisibility();
      });

      // ðŸŸ¢ "ë²„íŠ¼ì´ ì¡´ìž¬í•  ë•Œë§Œ" ì´ë²¤íŠ¸ë¥¼ ì—°ê²°í•©ë‹ˆë‹¤.
      hideButton.addEventListener('click', () => {
        history.pushState(null, '', '/');
        updateVisibility();
      });

      window.addEventListener('popstate', updateVisibility);
      updateVisibility();
    });
  script(src='/main.js')