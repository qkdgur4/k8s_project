// frontend/views/home.pug (ìµœì¢… ì™„ì„±ë³¸ - Validation ì¶”ê°€)

doctype html
html
  head
    meta(charset='utf-8')
    title í•œìž…ë¡œê·¸
    meta(name='viewport', content='width=device-width, initial-scale=1')
    link(rel='stylesheet', href='https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css')
    link(rel='stylesheet', href='/css/style.css')
  body
    .header.bg-light.mb-0
      .container
        h1: a(href='/', class='text-dark text-decoration-none') í•œìž…ë¡œê·¸ðŸ½
        p.text-muted.mb-0 ìž‘ì€ í•œìž…ì—ë„ ì´ì•¼ê¸°ê°€ ë‹´ê²¨ìš” ðŸ²
    .container.mb-5
      h3.mb-4.text-primary ê¸€ ìž‘ì„±í•˜ê¸°
      button.btn.btn-outline-primary.mb-3#show-form-btn ìƒˆ ë¦¬ë·° ìž‘ì„±í•˜ê¸°
      #review-form-wrapper(style="display: none;")
        form#new-review-form
          .form-group
            label(for='name') ì´ë¦„
            //- ðŸŸ¢ 'required' ì†ì„± ì¶”ê°€
            input#name.form-control(type='text' name='name' placeholder='ìµëª…ë„ ê°€ëŠ¥í•´ìš”' required)
          .form-group
            label(for='store') ê°€ê²Œëª…
            //- ðŸŸ¢ 'required' ì†ì„± ì¶”ê°€
            input#store.form-control(type='text' name='store' placeholder='ë°©ë¬¸í•œ ìŒì‹ì  ì´ë¦„ì„ ì ì–´ì£¼ì„¸ìš”' required)
          .form-group
            label(for='category') ìŒì‹ ë¶„ë¥˜
            //- ðŸŸ¢ 'required' ì†ì„± ì¶”ê°€
            select#category.form-control(name='category' required)
              option(value='') -- ì„ íƒ --
              option(value='í•œì‹') í•œì‹
              option(value='ì¤‘ì‹') ì¤‘ì‹
              option(value='ì¼ì‹') ì¼ì‹
              option(value='ì–‘ì‹') ì–‘ì‹
              option(value='ë¶„ì‹') ë¶„ì‹
              option(value='ê¸°íƒ€') ê¸°íƒ€
          .form-group
            label(for='menu') ë¨¹ì€ ìŒì‹
            //- ðŸŸ¢ 'required' ì†ì„± ì¶”ê°€
            input#menu.form-control(type='text' name='menu' placeholder='ì˜ˆ: ê¹€ì¹˜ì°Œê°œ, í¬ë¦¼íŒŒìŠ¤íƒ€ ë“±' required)
          .form-group
            label(for='taste') ë§› í‰ì 
            //- ðŸŸ¢ 'required' ì†ì„± ì¶”ê°€
            select#taste.form-control(name='taste' required)
              option(value='') -- ì„ íƒ --
              option(value='5') â˜…â˜…â˜…â˜…â˜…
              option(value='4') â˜…â˜…â˜…â˜…â˜†
              option(value='3') â˜…â˜…â˜…â˜†â˜†
              option(value='2') â˜…â˜…â˜†â˜†â˜†
              option(value='1') â˜…â˜†â˜†â˜†â˜†
          .form-group
            label(for='mood') ë¶„ìœ„ê¸°
            //- ðŸŸ¢ 'required' ì†ì„± ì¶”ê°€
            input#mood.form-control(type='text' name='mood' placeholder='ì¡°ìš©í•¨, í™œê¸°ì°¸, ê°€ì¡±ì , íŠ¸ë Œë”” ë“±' required)
          .form-group
            label(for='memo') ì¶”ê°€ ë©”ëª¨
            //- ë©”ëª¨ëŠ” ì„ íƒ ì‚¬í•­ì´ë¯€ë¡œ 'required'ë¥¼ ì¶”ê°€í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
            textarea#memo.form-control(name='memo' rows='4' placeholder='ìœ„ìƒ ìƒíƒœ, ìœ„ì¹˜, ê±¸ë¦¬ëŠ” ì‹œê°„ ë“±ì„ ì ì–´ì£¼ì„¸ìš”')
          .form-group
            label(for='recommend') ì¶”ì²œ ì—¬ë¶€
            //- ðŸŸ¢ 'required' ì†ì„± ì¶”ê°€
            select#recommend.form-control(name='recommend' required)
              option(value='') -- ì„ íƒ --
              option(value='yes') ì¶”ì²œí•´ìš” ðŸ‘
              option(value='no') ì•„ì‰¬ì›Œìš” ðŸ‘Ž
          button.btn.btn-success.btn-block(type='submit') ìž‘ì„± ì™„ë£Œ
          button.btn.btn-secondary.btn-block(type='button')#hide-form-btn ì·¨ì†Œ
    .container-fluid.posts.mt-5
      .mb-4.text-center
        - const categories = ['ì „ì²´', 'í•œì‹', 'ì¤‘ì‹', 'ì¼ì‹', 'ì–‘ì‹', 'ë¶„ì‹', 'ê¸°íƒ€']
        each cat in categories
          a(href=`/?category=${cat}`, class=`btn ${currentCategory === cat ? 'btn-primary' : 'btn-outline-secondary'} mr-2 mb-2`)= cat
      include list.pug
  
  //- (íŽ˜ì´ì§€ í•˜ë‹¨ ìŠ¤í¬ë¦½íŠ¸ ë¶€ë¶„ì€ ì´ì „ê³¼ ë™ì¼)
  script.
    document.addEventListener('DOMContentLoaded', () => {
      const showButton = document.getElementById('show-form-btn');
      const hideButton = document.getElementById('hide-form-btn');
      const formWrapper = document.getElementById('review-form-wrapper');
      
      function updateFormVisibility() {
        if (window.location.pathname === '/reviews/new') {
          formWrapper.style.display = 'block';
          showButton.style.display = 'none';
        } else {
          formWrapper.style.display = 'none';
          showButton.style.display = 'block';
        }
      }

      showButton.addEventListener('click', () => {
        history.pushState(null, '', '/reviews/new');
        updateFormVisibility();
      });

      hideButton.addEventListener('click', () => {
        history.pushState(null, '', '/');
        updateFormVisibility();
      });

      window.addEventListener('popstate', () => {
        updateFormVisibility();
      });

      updateFormVisibility();
    });
  script(src='/main.js')